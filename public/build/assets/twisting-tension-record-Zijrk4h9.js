import{r as m,j as e}from"./app-Bzkn-pxs.js";import{c as he,a as xe}from"./index-BP0LCq74.js";import{a as I,u as X,d as ge,c as A,B as p}from"./createLucideIcon-DXGtVaN5.js";import{n as J,R as fe,W as be,C as Ne,T as ve,D as je,P as we,O as Se,b as Ce,a as Y,o as B,X as K}from"./app-layout-DmDEcB4A.js";import{C as z,a as L,d as V,b as q}from"./card-DiXI6IZe.js";import{I as j}from"./input-_uek4hTr.js";import{L as w}from"./label-Ttq9miSX.js";import{S as G}from"./separator-BadBRiX-.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Te=I("ArrowLeft",ye);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],W=I("ChevronLeft",Ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],F=I("Delete",ke);var Q="AlertDialog",[De,Nt]=he(Q,[J]),S=J(),Z=a=>{const{__scopeAlertDialog:t,...s}=a,r=S(t);return e.jsx(fe,{...r,...s,modal:!0})};Z.displayName=Q;var Pe="AlertDialogTrigger",$e=m.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,o=S(s);return e.jsx(Ce,{...o,...r,ref:t})});$e.displayName=Pe;var Ee="AlertDialogPortal",ee=a=>{const{__scopeAlertDialog:t,...s}=a,r=S(t);return e.jsx(we,{...r,...s})};ee.displayName=Ee;var Re="AlertDialogOverlay",te=m.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,o=S(s);return e.jsx(Se,{...o,...r,ref:t})});te.displayName=Re;var D="AlertDialogContent",[_e,Oe]=De(D),Me=ge("AlertDialogContent"),se=m.forwardRef((a,t)=>{const{__scopeAlertDialog:s,children:r,...o}=a,n=S(s),i=m.useRef(null),l=X(t,i),c=m.useRef(null);return e.jsx(be,{contentName:D,titleName:re,docsSlug:"alert-dialog",children:e.jsx(_e,{scope:s,cancelRef:c,children:e.jsxs(Ne,{role:"alertdialog",...n,...o,ref:l,onOpenAutoFocus:xe(o.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[e.jsx(Me,{children:r}),e.jsx(Le,{contentRef:i})]})})})});se.displayName=D;var re="AlertDialogTitle",ae=m.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,o=S(s);return e.jsx(ve,{...o,...r,ref:t})});ae.displayName=re;var oe="AlertDialogDescription",ne=m.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,o=S(s);return e.jsx(je,{...o,...r,ref:t})});ne.displayName=oe;var Fe="AlertDialogAction",Ie=m.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,o=S(s);return e.jsx(Y,{...o,...r,ref:t})});Ie.displayName=Fe;var ie="AlertDialogCancel",ze=m.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,{cancelRef:o}=Oe(ie,s),n=S(s),i=X(t,o);return e.jsx(Y,{...n,...r,ref:i})});ze.displayName=ie;var Le=({contentRef:a})=>{const t=`\`${D}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${D}\` by passing a \`${oe}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${D}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return m.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,a]),null},Ve=Z,Ue=ee,He=te,Be=se,Ge=ae,We=ne;function Xe({...a}){return e.jsx(Ve,{"data-slot":"alert-dialog",...a})}function Je({...a}){return e.jsx(Ue,{"data-slot":"alert-dialog-portal",...a})}function Ye({className:a,...t}){return e.jsx(He,{"data-slot":"alert-dialog-overlay",className:A("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...t})}function Ke({className:a,...t}){return e.jsxs(Je,{children:[e.jsx(Ye,{}),e.jsx(Be,{"data-slot":"alert-dialog-content",className:A("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...t})]})}function qe({className:a,...t}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:A("flex flex-col gap-2 text-center sm:text-left",a),...t})}function Qe({className:a,...t}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:A("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...t})}function Ze({className:a,...t}){return e.jsx(Ge,{"data-slot":"alert-dialog-title",className:A("text-lg font-semibold",a),...t})}function et({className:a,...t}){return e.jsx(We,{"data-slot":"alert-dialog-description",className:A("text-muted-foreground text-sm",a),...t})}function E(a,t){try{typeof window<"u"&&localStorage.setItem(a,JSON.stringify(t))}catch(s){console.warn(`Failed to save to localStorage for key "${a}":`,s)}}function v(a,t){try{if(typeof window<"u"){const s=localStorage.getItem(a);if(s)return JSON.parse(s)}}catch(s){console.warn(`Failed to load from localStorage for key "${a}":`,s)}return t}function tt(a){try{typeof window<"u"&&localStorage.removeItem(a)}catch(t){console.warn(`Failed to remove from localStorage for key "${a}":`,t)}}function le(){const a=["twisting-form-data","weaving-form-data","twisting-spindle-data","weaving-creel-data","twisting-problems","weaving-problems","twisting-numpad-state","weaving-numpad-state"];console.log("Clearing localStorage keys:",a),a.forEach(t=>{tt(t),console.log(`Cleared: ${t}`)}),console.log("All app data cleared from localStorage")}function U(a){return Array.isArray(a)?a.map(t=>({...t,timestamp:new Date(t.timestamp)})):[]}class st{baseUrl;constructor(){this.baseUrl="http://127.0.0.1:8000"}getHeaders(){return{"Content-Type":"application/json",Accept:"application/json"}}async saveTensionRecord(t){try{await fetch(`${this.baseUrl}/csrf-token`,{credentials:"include"});const s=document.cookie.match(/XSRF-TOKEN=([^;]+)/),r=s?decodeURIComponent(s[1]):"";console.log("🔍 Cookies:",document.cookie),console.log("🧩 Extracted CSRF token:",r);const o=await fetch(`${this.baseUrl}/tension-records`,{method:"POST",headers:{...this.getHeaders(),"X-XSRF-TOKEN":r},body:JSON.stringify(t),credentials:"include"});console.log("Response status:",o.status);const n=await o.text();console.log("Response body:",n);let i;try{i=JSON.parse(n)}catch{i={message:n}}return o.ok?{success:i.status==="success"||i.success===!0,id:i.id||i.data?.id,message:i.message,data:i.data}:{success:!1,message:i.message||`HTTP ${o.status}`,error:i.error||n}}catch(s){return console.error("Save failed:",s),{success:!1,error:s.message||"Unknown error"}}}async getTensionRecords(t,s=1){try{const r=new URLSearchParams;t&&r.append("type",t),r.append("page",s.toString());const o=`${this.baseUrl}/tension-records?${r.toString()}`,n=await fetch(o,{headers:this.getHeaders()});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();return i.data&&Array.isArray(i.data)?{records:i.data.map(c=>({...c,timestamp:c.timestamp||c.created_at})),pagination:{current_page:i.current_page,last_page:i.last_page,per_page:i.per_page,total:i.total}}:{records:(Array.isArray(i)?i:i.data||[]).map(c=>({...c,timestamp:c.timestamp||c.created_at}))}}catch(r){return console.error("Failed to fetch tension records:",r),{records:[]}}}async getTensionRecord(t){try{const s=await fetch(`${this.baseUrl}/tension-records/${t}`,{headers:this.getHeaders()});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const r=await s.json(),o=r.data||r;return{...o,timestamp:o.timestamp||o.created_at}}catch(s){return console.error("Failed to fetch tension record:",s),null}}async deleteTensionRecord(t){try{const s=await fetch(`${this.baseUrl}/tension-records/${t}`,{method:"DELETE",headers:this.getHeaders()});if(!s.ok){const r=await s.json();throw new Error(r.message||`HTTP error! status: ${s.status}`)}return{success:!0}}catch(s){return console.error("Failed to delete tension record:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async updateTensionRecord(t,s){try{const r=await fetch(`${this.baseUrl}/tension-records/${t}`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(s)});if(!r.ok){const o=await r.json();throw new Error(o.message||`HTTP error! status: ${r.status}`)}return{success:!0}}catch(r){return console.error("Failed to update tension record:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}}const rt=new st;function at(){const a=v("twisting-spindle-data",{}),t=v("twisting-form-data",{machineNumber:"",itemNumber:"",metersCheck:"",operator:"",dtexNumber:"",tpm:"",specTens:"",tensPlus:"",rpm:""}),s=v("twisting-problems",[]),r=U(s),o=ot(a,t,r),n=Object.entries(a),i=n.length,l=n.filter(([d,u])=>u.max!==null&&u.min!==null).length,c=i>0?Math.round(l/84*100):0;return{record_type:"twisting",timestamp:new Date().toISOString(),csv_data:o,form_data:t,measurement_data:a,problems:r,metadata:{total_measurements:i,completed_measurements:l,progress_percentage:c,operator:t.operator,machine_number:t.machineNumber,item_number:t.itemNumber}}}function ot(a,t,s){const r=[];return r.push("TWISTING TENSION DATA EXPORT"),r.push(`Export Date: ${new Date().toLocaleString()}`),r.push(""),r.push("=== CONFIGURATION PARAMETERS ==="),r.push("Parameter,Value"),r.push(`Operator,${t.operator}`),r.push(`Item Number,${t.itemNumber}`),r.push(`Meters Check,${t.metersCheck}`),r.push(`Dtex Number,${t.dtexNumber}`),r.push(`TPM,${t.tpm}`),r.push(`Spec Tens,${t.specTens}`),r.push(`Tens ±,${t.tensPlus}`),r.push(`RPM,${t.rpm}`),r.push(`Machine Number,${t.machineNumber}`),r.push(""),r.push("=== TENSION MEASUREMENT DATA ==="),r.push("Spindle Number,Max Value,Min Value"),Object.entries(a).forEach(([o,n])=>{const i=n.max!==null?n.max:"",l=n.min!==null?n.min:"";r.push(`${o},${i},${l}`)}),r.push(""),r.push("=== PROBLEM REPORTS ==="),r.push("Spindle Number,Description,Timestamp"),s.length>0?s.forEach(o=>{const n=o.timestamp.toLocaleString(),i=`"${o.description.replace(/"/g,'""')}"`;r.push(`${o.spindleNumber},${i},${n}`)}):r.push("No problems reported"),r.join(`
`)}async function nt(a,t,s,r="twisting-tension-data",o=!0){const n=[];if(n.push("TWISTING TENSION DATA EXPORT"),n.push(`Export Date: ${new Date().toLocaleString()}`),n.push(""),n.push("=== CONFIGURATION PARAMETERS ==="),n.push("Parameter,Value"),n.push(`Operator,${t.operator}`),n.push(`Item Number,${t.itemNumber}`),n.push(`Meters Check,${t.metersCheck}`),n.push(`Dtex Number,${t.dtexNumber}`),n.push(`TPM,${t.tpm}`),n.push(`Spec Tens,${t.specTens}`),n.push(`Tens ±,${t.tensPlus}`),n.push(`RPM,${t.rpm}`),n.push(`Machine Number,${t.machineNumber}`),n.push(""),n.push("=== TENSION MEASUREMENT DATA ==="),n.push("Spindle Number,Max Value,Min Value"),Object.entries(a).forEach(([d,u])=>{const b=u.max!==null?u.max:"",C=u.min!==null?u.min:"";n.push(`${d},${b},${C}`)}),n.push(""),n.push("=== PROBLEM REPORTS ==="),n.push("Spindle Number,Description,Timestamp"),s.length>0?s.forEach(d=>{const u=d.timestamp.toLocaleString(),b=`"${d.description.replace(/"/g,'""')}"`;n.push(`${d.spindleNumber},${b},${u}`)}):n.push("No problems reported"),o)try{const d=at(),u=await rt.saveTensionRecord(d);u.success?(console.log("✅ Twisting data saved to database with ID:",u.id),M("Data saved to database successfully!","success")):(console.error("❌ Failed to save twisting data to database:",u.error),M("Failed to save to database: "+u.error,"error"))}catch(d){console.error("❌ Database save error:",d),M("Database connection error","error")}const i=n.join(`
`),l=new Blob([i],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a");if(c.download!==void 0){const d=URL.createObjectURL(l);c.setAttribute("href",d),c.setAttribute("download",`${r}-${new Date().toISOString().split("T")[0]}.csv`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}}function M(a,t="info"){const s=document.createElement("div");s.className=`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm ${t==="success"?"bg-green-500 text-white":t==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,s.textContent=a,document.body.appendChild(s),setTimeout(()=>{s.parentNode&&s.parentNode.removeChild(s)},5e3)}function it({display:a,setDisplay:t,counter:s,setCounter:r,valueType:o,setValueType:n,spindleData:i,setSpindleData:l,formData:c,problems:d,onReportProblem:u,onOpenRecorder:b,onDataCleared:C}){const[h,f]=m.useState(!1),T=i[s]||{max:null,min:null},x=g=>{t(a==="0"?g:a+g)},k=()=>{t("0")},R=()=>{a.length>1?t(a.slice(0,-1)):t("0")},_=()=>{r(s<84?s+1:84)},P=()=>{r(s>1?s-1:1)},O=()=>{n(o==="Max"?"Min":"Max")},ce=g=>{l(y=>{const $=y[s]??{max:null,min:null};return{...y,[s]:{...$,[o.toLowerCase()]:g}}})},de=()=>{const g=Number.parseFloat(a);isNaN(g)||(ce(g),t("0"),O(),console.log(`Submitted ${o} value ${g} for Spindle ${s}`))},H=g=>{f(!1);const y=v("twisting-spindle-data",{}),$=v("twisting-form-data",{machineNumber:"",itemNumber:"",metersCheck:"",operator:"",dtexNumber:"",tpm:"",specTens:"",tensPlus:"",rpm:""}),ue=v("twisting-problems",[]),pe=U(ue);nt(y,$,pe,"twisting-tension-data"),console.log("Exported all twisting data from localStorage to CSV"),g||(le(),console.log("Cleared all app data from localStorage"),t("0"),r(1),n("Max"),l({}),C?.(),console.log("All data cleared - ready for new session"))},N=({children:g,onClick:y,className:$=""})=>e.jsx(p,{variant:"outline",size:"sm",className:`h-10 text-base font-medium transition-colors hover:bg-accent hover:text-accent-foreground ${$}`,onClick:y,children:g}),me=()=>{l(g=>{const y=g[s]??{max:null,min:null};return{...g,[s]:{...y,[o.toLowerCase()]:null}}}),console.log(`Deleted ${o} value for Spindle ${s}`)};return e.jsxs("div",{className:"flex min-h-screen items-center justify-center bg-background p-2",children:[e.jsxs(z,{className:"mx-auto w-full max-w-xs shadow-lg",children:[e.jsxs(L,{className:"pb-2",children:[e.jsxs("div",{className:"mb-3 grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"rounded-lg border border-green-200 bg-green-50 p-2 text-center",children:[e.jsx("div",{className:"mb-1 text-xs font-medium text-green-700",children:"Max Value"}),e.jsx("div",{className:"font-mono text-sm font-bold text-green-800",children:T.max??"--"})]}),e.jsxs("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-2 text-center",children:[e.jsx("div",{className:"mb-1 text-xs font-medium text-blue-700",children:"Min Value"}),e.jsx("div",{className:"font-mono text-sm font-bold text-blue-800",children:T.min??"--"})]})]}),e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-foreground",children:"Spd No."}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{variant:"outline",size:"sm",className:"h-8 w-8 bg-transparent p-0",onClick:P,disabled:s===1,children:e.jsx(W,{className:"h-3 w-3"})}),e.jsxs("div",{className:"min-w-[50px] text-center text-sm font-semibold text-foreground",children:[s," / 84"]}),e.jsx(p,{variant:"outline",size:"sm",className:"h-8 w-8 bg-transparent p-0",onClick:_,disabled:s===84,children:e.jsx(B,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-foreground",children:"Value type"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{variant:"outline",size:"sm",className:"h-8 w-8 bg-transparent p-0",onClick:O,children:e.jsx(W,{className:"h-3 w-3"})}),e.jsx("div",{className:`min-w-[50px] text-center text-sm font-semibold ${o==="Max"?"text-green-700":"text-blue-700"}`,children:o}),e.jsx(p,{variant:"outline",size:"sm",className:"h-8 w-8 bg-transparent p-0",onClick:O,children:e.jsx(B,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-right",children:[e.jsx("div",{className:"flex min-h-[2rem] items-center justify-end font-mono text-2xl font-bold text-foreground",children:a}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Entering ",o," for Spindle ",s]})]})]}),e.jsxs(V,{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(p,{variant:"default",size:"sm",className:"h-10 bg-blue-600 text-sm font-medium text-white hover:bg-blue-700",onClick:k,children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Clear"]}),e.jsxs(p,{variant:"outline",size:"sm",className:"h-10 bg-transparent text-xs font-medium transition-colors hover:bg-destructive hover:text-destructive-foreground",onClick:R,children:[e.jsx(F,{className:"mr-1 h-3 w-3"}),"Backspace"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(N,{onClick:()=>x("7"),children:"7"}),e.jsx(N,{onClick:()=>x("8"),children:"8"}),e.jsx(N,{onClick:()=>x("9"),children:"9"}),e.jsx(N,{onClick:()=>x("4"),children:"4"}),e.jsx(N,{onClick:()=>x("5"),children:"5"}),e.jsx(N,{onClick:()=>x("6"),children:"6"}),e.jsx(N,{onClick:()=>x("1"),children:"1"}),e.jsx(N,{onClick:()=>x("2"),children:"2"}),e.jsx(N,{onClick:()=>x("3"),children:"3"}),e.jsx(N,{onClick:()=>x("0"),className:"col-span-2",children:"0"}),e.jsx(N,{onClick:()=>x("."),children:"."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(p,{size:"sm",className:"h-10 bg-green-600 text-sm font-medium text-white hover:bg-green-700",onClick:()=>f(!0),children:"Finish"}),e.jsx(p,{size:"sm",className:"h-10 bg-primary text-sm font-medium hover:bg-primary/90",onClick:de,children:"Submit"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",className:"h-10 bg-transparent text-sm font-medium hover:bg-accent hover:text-accent-foreground",onClick:()=>{console.log("Data Recorder button clicked"),b?.()},children:"Proc. Parameters"}),e.jsxs(p,{variant:"outline",size:"sm",className:"h-10 bg-transparent text-sm font-medium transition-colors hover:bg-destructive hover:text-destructive-foreground",onClick:me,children:[e.jsx(F,{className:"mr-1 h-3 w-3"}),"Delete ",o]})]}),e.jsxs(p,{variant:"outline",size:"sm",className:"h-10 w-full bg-transparent text-sm font-medium transition-colors hover:border-orange-300 hover:bg-orange-50 hover:text-orange-600",onClick:()=>{console.log("Report Problem clicked for Spindle",s),u?.(s)},children:["Report Problem for Spd #",s]})]})]}),e.jsx(Xe,{open:h,onOpenChange:f,children:e.jsxs(Ke,{children:[e.jsxs(qe,{children:[e.jsx(Ze,{children:"Finish Measurement Session"}),e.jsx(et,{children:"Would you like to clear the data on your local device afterwards?"})]}),e.jsxs(Qe,{children:[e.jsx(p,{variant:"destructive",onClick:()=>H(!1),children:"Yes, clear all"}),e.jsx(p,{onClick:()=>H(!0),children:"No, keep them"})]})]})})]})}function lt({className:a,...t}){return e.jsx("textarea",{"data-slot":"textarea",className:A("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...t})}function ct({onBack:a,spindleNumber:t,submittedProblems:s,setSubmittedProblems:r}){const[o,n]=m.useState(""),[i,l]=m.useState(null),c=()=>{if(o.trim()){const h={id:Date.now(),spindleNumber:t,description:o.trim(),timestamp:new Date};r([...s,h]),n(""),l(null),console.log("Problem submitted for Spindle",t,":",o)}},d=h=>{const f=s.filter((T,x)=>x!==h);r(f),l(null),console.log("Problem deleted at index:",h)},u=()=>{i!==null&&d(i)},b=()=>{n(""),console.log("Current problem text cleared")},C=()=>{console.log("Back button clicked"),a?.()};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background p-2",children:e.jsxs(z,{className:"w-full max-w-xs mx-auto shadow-lg",children:[e.jsxs(L,{className:"pb-2",children:[e.jsx(q,{className:"text-lg font-semibold text-center",children:"Problem Reports"}),e.jsxs("div",{className:"text-sm text-center text-muted-foreground",children:["Reporting for Spindle #",t]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 min-h-[100px] max-h-[150px] overflow-y-auto",children:[e.jsxs("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:["All Problems: ",i!==null&&"(Select to delete)"]}),s.length>0?e.jsx("div",{className:"space-y-1",children:s.map((h,f)=>e.jsxs("div",{className:`text-xs text-foreground bg-background/50 rounded p-2 border flex items-start justify-between gap-1 cursor-pointer transition-colors ${i===f?"border-destructive bg-destructive/10":"hover:bg-background/70"}`,onClick:()=>l(i===f?null:f),children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-1 mb-1",children:e.jsxs("span",{className:"text-xs font-semibold text-blue-600",children:["Spd #",h.spindleNumber]})}),e.jsx("span",{className:"text-xs",children:h.description})]}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:T=>{T.stopPropagation(),d(f)},children:e.jsx(K,{className:"w-2 h-2"})})]},h.id))}):e.jsx("div",{className:"text-xs text-muted-foreground italic",children:"No problems reported yet"})]})]}),e.jsxs(V,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"problem-description",className:"text-xs font-medium text-foreground",children:["Describe the problem for Spindle #",t,":"]}),e.jsx(lt,{id:"problem-description",placeholder:`Enter problem description for Spindle ${t}...`,value:o,onChange:h=>n(h.target.value),className:"min-h-[80px] resize-none text-sm",maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[o.length,"/500"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{size:"sm",className:"w-full h-10 text-sm font-medium bg-primary hover:bg-primary/90",onClick:c,disabled:!o.trim(),children:["Submit Problem for Spd #",t]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",className:"h-10 text-sm font-medium hover:bg-destructive hover:text-destructive-foreground transition-colors bg-transparent",onClick:i!==null?u:b,disabled:i===null&&!o,children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),i!==null?"Del Selected":"Clear"]}),e.jsxs(p,{variant:"outline",size:"sm",className:"h-10 text-sm font-medium hover:bg-accent hover:text-accent-foreground bg-transparent",onClick:C,children:[e.jsx(Te,{className:"w-3 h-3 mr-1"}),"Back"]})]})]})]})]})})}function dt({formData:a,setFormData:t,onStartRecording:s}){const r=(l,c)=>{t(d=>({...d,[l]:c}))},o=()=>{console.log("Started recording with data:",a),s?.()},n=()=>{t({machineNumber:"",itemNumber:"",metersCheck:"",operator:"",dtexNumber:"",tpm:"",specTens:"",tensPlus:"",rpm:""}),console.log("Data cleared")},i=()=>{confirm("Are you sure you want to clear all saved data? This will remove all forms, measurements, and problem reports.")&&(le(),n(),console.log("All app data cleared from localStorage"))};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background p-2",children:e.jsxs(z,{className:"w-full max-w-xs mx-auto shadow-lg",children:[e.jsxs(L,{className:"pb-3",children:[e.jsx(q,{className:"text-lg font-semibold text-center",children:"Twisting Tension Data Recorder"}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Configure recording parameters"}),e.jsx(G,{className:"mt-3"})]}),e.jsxs(V,{className:"space-y-1",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"operator",className:"text-xs font-medium text-foreground",children:"Operator"}),e.jsx(j,{id:"operator",type:"text",value:a.operator,onChange:l=>r("operator",l.target.value),className:"h-7 text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"itemNumber",className:"text-xs font-medium text-foreground",children:"Item Number"}),e.jsx(j,{id:"itemNumber",type:"text",value:a.itemNumber,onChange:l=>r("itemNumber",l.target.value),className:"h-7 text-sm"})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"metersCheck",className:"text-xs font-medium text-foreground",children:"Meters Check"}),e.jsx(j,{id:"metersCheck",type:"text",value:a.metersCheck,onChange:l=>r("metersCheck",l.target.value),className:"h-7 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"dtexNumber",className:"text-xs font-medium text-foreground",children:"Dtex Number"}),e.jsx(j,{id:"dtexNumber",type:"text",value:a.dtexNumber,onChange:l=>r("dtexNumber",l.target.value),className:"h-7 text-sm"})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"tpm",className:"text-xs font-medium text-foreground",children:"TPM"}),e.jsx(j,{id:"tpm",type:"text",value:a.tpm,onChange:l=>r("tpm",l.target.value),className:"h-7 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"specTens",className:"text-xs font-medium text-foreground",children:"Spec Tens"}),e.jsx(j,{id:"specTens",type:"text",value:a.specTens,onChange:l=>r("specTens",l.target.value),className:"h-7 text-sm"})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"tensPlus",className:"text-xs font-medium text-foreground",children:"Tens ±"}),e.jsx(j,{id:"tensPlus",type:"text",value:a.tensPlus,onChange:l=>r("tensPlus",l.target.value),className:"h-7 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"rpm",className:"text-xs font-medium text-foreground",children:"RPM"}),e.jsx(j,{id:"rpm",type:"text",value:a.rpm,onChange:l=>r("rpm",l.target.value),className:"h-7 text-sm"})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"machineNumber",className:"text-xs font-medium text-foreground",children:"Machine Number"}),e.jsx(j,{id:"machineNumber",type:"text",value:a.machineNumber,onChange:l=>r("machineNumber",l.target.value),className:"h-7 text-sm"})]})]})]}),e.jsx("div",{className:"py-2",children:e.jsx(G,{})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(p,{size:"sm",className:"w-full h-10 text-sm font-medium",onClick:o,children:"Start Recording"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",className:"h-10 text-sm font-medium bg-transparent",onClick:n,children:"Clear Form"}),e.jsx(p,{variant:"outline",size:"sm",className:"h-10 text-xs font-medium hover:bg-destructive hover:text-destructive-foreground bg-transparent",onClick:i,children:"Clear All Data"})]})]})]})]})})}function vt(){const[a,t]=m.useState("0"),[s,r]=m.useState(1),[o,n]=m.useState("Max"),[i,l]=m.useState({}),[c,d]=m.useState({machineNumber:"",itemNumber:"",metersCheck:"",operator:"",dtexNumber:"",tpm:"",specTens:"",tensPlus:"",rpm:""}),[u,b]=m.useState([]),[C,h]=m.useState("recorder"),[f,T]=m.useState(1);m.useEffect(()=>{const k=v("twisting-form-data",c),R=v("twisting-spindle-data",i),_=v("twisting-problems",[]),P=v("twisting-numpad-state",{display:"0",counter:1,valueType:"Max"});d(k),l(R),b(U(_)),t(P.display),r(P.counter),n(P.valueType)},[]),m.useEffect(()=>{E("twisting-form-data",c)},[c]),m.useEffect(()=>{E("twisting-spindle-data",i)},[i]),m.useEffect(()=>{E("twisting-problems",u)},[u]),m.useEffect(()=>{E("twisting-numpad-state",{display:a,counter:s,valueType:o})},[a,s,o]);const x=()=>{d({machineNumber:"",itemNumber:"",metersCheck:"",operator:"",dtexNumber:"",tpm:"",specTens:"",tensPlus:"",rpm:""}),l({}),b([]),t("0"),r(1),n("Max"),h("recorder"),console.log("All twisting data cleared and reset to initial state - returned to params form")};return C==="problems"?e.jsx(ct,{onBack:()=>h("numpad"),spindleNumber:f,submittedProblems:u,setSubmittedProblems:b}):C==="recorder"?e.jsx(dt,{formData:c,setFormData:d,onStartRecording:()=>h("numpad")}):e.jsx(it,{display:a,setDisplay:t,counter:s,setCounter:r,valueType:o,setValueType:n,spindleData:i,setSpindleData:l,formData:c,problems:u,onReportProblem:k=>{T(k),h("problems")},onOpenRecorder:()=>h("recorder"),onDataCleared:x})}export{vt as T};
